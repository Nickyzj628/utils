// @bun
var E=(...H)=>{console.log(`${new Date().toLocaleTimeString()}`,...H)};var L=(H,z=-1)=>{let W=new Map,D=(...$)=>{let x=JSON.stringify($),I=Date.now(),M=W.get(x);if(M&&I<M.expiresAt)return M.value;let C=z===-1?1/0:I+z*1000,Q={setTtl:(X)=>{C=I+X*1000}},Y=H.apply(Q,$);if(Y instanceof Promise){let X=Y.then((Z)=>{return W.set(x,{value:Z,expiresAt:C}),Z});return W.set(x,{value:X,expiresAt:C}),X}return W.set(x,{value:Y,expiresAt:C}),Y};return D.clear=()=>W.clear(),D.updateTtl=($)=>{z=$;let x=Date.now(),I=x+$*1000;for(let[M,C]of W.entries())if(C.expiresAt>x)C.expiresAt=I,W.set(M,C)},D};var J=(H)=>{return H?.constructor===Object},_=(H)=>{return H===null||H===void 0||typeof H!=="object"&&typeof H!=="function"},F=(H)=>{return!H},R=(H)=>{return!!H},P=(H)=>{return H===null||H===void 0};var G=(H,z)=>{let W={...H};for(let D of Object.keys(z)){let $=W[D],x=z[D];if(_($)&&_(x)){W[D]=x;continue}if(Array.isArray($)&&Array.isArray(x)){W[D]=$.concat(x);continue}if(J($)&&J(x)){W[D]=G($,x);continue}W[D]=x}return W},f=(H,z)=>{if(Array.isArray(H))return H.map((W)=>f(W,z));if(J(H))return Object.keys(H).reduce((D,$)=>{let x=z($),I=H[$];return D[x]=f(I,z),D},{});return H},q=(H,z)=>{if(Array.isArray(H))return H.map((W,D)=>{if(J(W))return q(W,z);return z(W,D)});if(J(H))return Object.keys(H).reduce((D,$)=>{let x=H[$];if(J(x)||Array.isArray(x))D[$]=q(x,z);else D[$]=z(x,$);return D},{});return H};var O=(H="",z={})=>{let W=async(D,$={})=>{let x=new URL(H?`${H}${D}`:D),{params:I,parser:M,...C}=G(z,$);if(J(I))Object.entries(I).forEach(([X,Z])=>{if(P(Z))return;x.searchParams.append(X,Z.toString())});if(J(C.body))C.body=JSON.stringify(C.body),C.headers={...C.headers,"Content-Type":"application/json"};let Q=await fetch(x,C);if(!Q.ok)throw Error(Q.statusText);return await(M?.(Q)??Q.json())};return{get:(D,$)=>W(D,{...$,method:"GET"}),post:(D,$,x)=>W(D,{...x,method:"POST",body:$}),put:(D,$,x)=>W(D,{...x,method:"PUT",body:$}),delete:(D,$)=>W(D,{...$,method:"DELETE"})}},h=async(H)=>{try{return[null,await H]}catch(z){return[z,void 0]}};var m=(H)=>{return H.replace(/_([a-zA-Z])/g,(z,W)=>W.toUpperCase())},k=(H)=>{return H.replace(/([A-Z])/g,(z,W)=>`_${W.toLowerCase()}`)},w=(H)=>{return H.charAt(0).toUpperCase()+H.slice(1)},g=(H)=>{return H.charAt(0).toLowerCase()+H.slice(1)},d=async(H)=>{if(!H.startsWith("http"))throw Error("\u56FE\u7247\u5730\u5740\u5FC5\u987B\u4EE5http\u6216https\u5F00\u5934");let W=await(await fetch(H)).arrayBuffer();return`data:image/jpeg;base64,${Buffer.from(W).toString("base64")}`};var j=async(H=150)=>{return new Promise((z)=>{setTimeout(z,H)})};export{L as withCache,h as to,E as timeLog,m as snakeToCamel,j as sleep,G as mergeObjects,q as mapValues,f as mapKeys,R as isTruthy,_ as isPrimitive,J as isObject,P as isNil,F as isFalsy,d as imageUrlToBase64,O as fetcher,g as decapitalize,w as capitalize,k as camelToSnake};
