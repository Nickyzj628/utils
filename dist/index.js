// @bun
var T=(...H)=>{console.log(`${new Date().toLocaleTimeString()}`,...H)};var x=async(H,I)=>{let{maxRetries:D=5,shouldStop:z=()=>!0}=I??{};for(let W=0;W<D;W++){let $=await H(W);if(z($))return $}throw Error(`\u8D85\u8FC7\u4E86\u6700\u5927\u5FAA\u73AF\u6B21\u6570\uFF08${D}\uFF09\u4E14\u672A\u6EE1\u8DB3\u505C\u6B62\u6267\u884C\u6761\u4EF6`)};var S=(H,I=-1)=>{let D=new Map,z=(...W)=>{let $=JSON.stringify(W),J=Date.now(),Y=D.get($);if(Y&&J<Y.expiresAt)return Y.value;let M=I===-1?1/0:J+I*1000,X={setTtl:(Z)=>{M=J+Z*1000}},_=H.apply(X,W);if(_ instanceof Promise){let Z=_.then((B)=>{return D.set($,{value:B,expiresAt:M}),B});return D.set($,{value:Z,expiresAt:M}),Z}return D.set($,{value:_,expiresAt:M}),_};return z.clear=()=>D.clear(),z.updateTtl=(W)=>{I=W;let $=Date.now(),J=$+W*1000;for(let[Y,M]of D.entries())if(M.expiresAt>$)M.expiresAt=J,D.set(Y,M)},z};var Q=(H)=>{return H?.constructor===Object},C=(H)=>{return H===null||H===void 0||typeof H!=="object"&&typeof H!=="function"},R=(H)=>{return!H},U=(H)=>{return!!H},P=(H)=>{return H===null||H===void 0};var G=(H,I)=>{let D={...H};for(let z of Object.keys(I)){let W=D[z],$=I[z];if(C(W)&&C($)){D[z]=$;continue}if(Array.isArray(W)&&Array.isArray($)){D[z]=W.concat($);continue}if(Q(W)&&Q($)){D[z]=G(W,$);continue}D[z]=$}return D},f=(H,I)=>{if(Array.isArray(H))return H.map((D)=>f(D,I));if(Q(H))return Object.keys(H).reduce((z,W)=>{let $=I(W),J=H[W];return z[$]=f(J,I),z},{});return H},q=(H,I)=>{if(Array.isArray(H))return H.map((D,z)=>{if(Q(D))return q(D,I);return I(D,z)});if(Q(H))return Object.keys(H).reduce((z,W)=>{let $=H[W];if(Q($)||Array.isArray($))z[W]=q($,I);else z[W]=I($,W);return z},{});return H};var E=(H="",I={})=>{let D=async(z,W={})=>{let $=new URL(H?`${H}${z}`:z),{params:J,parser:Y,...M}=G(I,W);if(Q(J))Object.entries(J).forEach(([Z,B])=>{if(P(B))return;$.searchParams.append(Z,B.toString())});if(Q(M.body))M.body=JSON.stringify(M.body),M.headers={...M.headers,"Content-Type":"application/json"};let X=await fetch($,M);if(!X.ok){if(X.headers.get("Content-Type")?.startsWith("application/json"))throw await X.json();throw Error(X.statusText)}return await(Y?.(X)??X.json())};return{get:(z,W)=>D(z,{...W,method:"GET"}),post:(z,W,$)=>D(z,{...$,method:"POST",body:W}),put:(z,W,$)=>D(z,{...$,method:"PUT",body:W}),delete:(z,W)=>D(z,{...W,method:"DELETE"})}},m=async(H)=>{try{return[null,await H]}catch(I){return[I,void 0]}};var w=(H)=>{return H.replace(/_([a-zA-Z])/g,(I,D)=>D.toUpperCase())},d=(H)=>{return H.replace(/([A-Z])/g,(I,D)=>`_${D.toLowerCase()}`)},c=(H)=>{return H.charAt(0).toUpperCase()+H.slice(1)},j=(H)=>{return H.charAt(0).toLowerCase()+H.slice(1)},v=async(H)=>{if(!H.startsWith("http"))throw Error("\u56FE\u7247\u5730\u5740\u5FC5\u987B\u4EE5http\u6216https\u5F00\u5934");let I="",D=await E().get(H,{parser:($)=>{return I=$.headers.get("Content-Type")||"image/jpeg",$.arrayBuffer()}}),W=Buffer.from(D).toString("base64");return`data:${I};base64,${W}`},y=(H="",I)=>{if(!H)return"";let{maxLength:D=1/0,disableNewLineReplace:z=!1,disableWhitespaceCollapse:W=!1,omission:$="..."}=I??{},J=H;if(!z)J=J.replace(/\r?\n/g,"\\n");else J=J.replace(/\r?\n/g," ");if(!W)J=J.replace(/\s+/g," ");if(J=J.trim(),D>0&&J.length>D)return J.slice(0,D)+$;return J};var p=async(H=150)=>{return new Promise((I)=>{setTimeout(I,H)})};export{S as withCache,m as to,T as timeLog,w as snakeToCamel,p as sleep,G as mergeObjects,q as mapValues,f as mapKeys,x as loopUntil,U as isTruthy,C as isPrimitive,Q as isObject,P as isNil,R as isFalsy,v as imageUrlToBase64,E as fetcher,j as decapitalize,y as compactStr,c as capitalize,d as camelToSnake};
