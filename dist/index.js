// @bun
var F=(...H)=>{console.log(`${new Date().toLocaleTimeString()}`,...H)};var R=async(H,W)=>{let{maxRetries:I=5,shouldStop:D=()=>!0}=W??{};for(let $=0;$<I;$++){let M=await H($);if(D(M))return M}throw Error(`\u8D85\u8FC7\u4E86\u6700\u5927\u5FAA\u73AF\u6B21\u6570\uFF08${I}\uFF09\u4E14\u672A\u6EE1\u8DB3\u505C\u6B62\u6267\u884C\u6761\u4EF6`)};var L=(H,W=-1)=>{let I=new Map,D=(...$)=>{let M=JSON.stringify($),z=Date.now(),Q=I.get(M);if(Q&&z<Q.expiresAt)return Q.value;let J=W===-1?1/0:z+W*1000,Z={setTtl:(_)=>{J=z+_*1000}},B=H.apply(Z,$);if(B instanceof Promise){let _=B.then((C)=>{return I.set(M,{value:C,expiresAt:J}),C});return I.set(M,{value:_,expiresAt:J}),_}return I.set(M,{value:B,expiresAt:J}),B};return D.clear=()=>I.clear(),D.updateTtl=($)=>{W=$;let M=Date.now(),z=M+$*1000;for(let[Q,J]of I.entries())if(J.expiresAt>M)J.expiresAt=z,I.set(Q,J)},D};var X=(H)=>{return H?.constructor===Object},G=(H)=>{return H===null||H===void 0||typeof H!=="object"&&typeof H!=="function"},U=(H)=>{return!H},f=(H)=>{return!!H},q=(H)=>{return H===null||H===void 0};var Y=(H,W)=>{let I={...H};for(let D of Object.keys(W)){let $=I[D],M=W[D];if(G($)&&G(M)){I[D]=M;continue}if(Array.isArray($)&&Array.isArray(M)){I[D]=$.concat(M);continue}if(X($)&&X(M)){I[D]=Y($,M);continue}I[D]=M}return I},P=(H,W)=>{if(Array.isArray(H))return H.map((I)=>P(I,W));if(X(H))return Object.keys(H).reduce((D,$)=>{let M=W($),z=H[$];return D[M]=P(z,W),D},{});return H},E=(H,W,I)=>{let{filter:D}=I??{};if(Array.isArray(H)){let $=H.map((M,z)=>{if(X(M))return E(M,W,I);return W(M,z)});if(D)return $.filter((M,z)=>D(M,z));return $}if(X(H))return Object.keys(H).reduce((M,z)=>{let Q=H[z],J;if(X(Q)||Array.isArray(Q))J=E(Q,W,I);else J=W(Q,z);if(!D||D(J,z))M[z]=J;return M},{});return H};var T=(H="",W={})=>{let I=async(D,$={})=>{let M=new URL(H?`${H}${D}`:D),{params:z,parser:Q,...J}=Y(W,$);if(X(z))Object.entries(z).forEach(([_,C])=>{if(q(C))return;M.searchParams.append(_,C.toString())});if(X(J.body))J.body=JSON.stringify(J.body),J.headers={...J.headers,"Content-Type":"application/json"};let Z=await fetch(M,J);if(!Z.ok){if(Z.headers.get("Content-Type")?.startsWith("application/json"))throw await Z.json();throw Error(Z.statusText)}return await(Q?.(Z)??Z.json())};return{get:(D,$)=>I(D,{...$,method:"GET"}),post:(D,$,M)=>I(D,{...M,method:"POST",body:$}),put:(D,$,M)=>I(D,{...M,method:"PUT",body:$}),delete:(D,$)=>I(D,{...$,method:"DELETE"})}},k=async(H)=>{try{return[null,await H]}catch(W){return[W,void 0]}};var w=(H,W)=>{return Math.floor(Math.random()*(W-H+1))+H};var m=(H)=>{return H.replace(/_([a-zA-Z])/g,(W,I)=>I.toUpperCase())},c=(H)=>{return H.replace(/([A-Z])/g,(W,I)=>`_${I.toLowerCase()}`)},v=(H)=>{return H.charAt(0).toUpperCase()+H.slice(1)},b=(H)=>{return H.charAt(0).toLowerCase()+H.slice(1)},y=async(H)=>{if(!H.startsWith("http"))throw Error("\u56FE\u7247\u5730\u5740\u5FC5\u987B\u4EE5http\u6216https\u5F00\u5934");let W="",I=await T().get(H,{parser:(M)=>{return W=M.headers.get("Content-Type")||"image/jpeg",M.arrayBuffer()}}),$=Buffer.from(I).toString("base64");return`data:${W};base64,${$}`},p=(H="",W)=>{if(!H)return"";let{maxLength:I=1/0,disableNewLineReplace:D=!1,disableWhitespaceCollapse:$=!1,omission:M="..."}=W??{},z=H;if(!D)z=z.replace(/\r?\n/g,"\\n");else z=z.replace(/\r?\n/g," ");if(!$)z=z.replace(/\s+/g," ");if(z=z.trim(),I>0&&z.length>I)return z.slice(0,I)+M;return z};var n=async(H=150)=>{return new Promise((W)=>{setTimeout(W,H)})},o=(H,W=300)=>{let I=null;return(...D)=>{if(I)clearTimeout(I);I=setTimeout(()=>{H(...D)},W)}},i=(H,W=300)=>{let I=null;return function(...D){if(!I)I=setTimeout(()=>{I=null,H.apply(this,D)},W)}};export{L as withCache,k as to,F as timeLog,i as throttle,m as snakeToCamel,n as sleep,w as randomInt,Y as mergeObjects,E as mapValues,P as mapKeys,R as loopUntil,f as isTruthy,G as isPrimitive,X as isObject,q as isNil,U as isFalsy,y as imageUrlToBase64,T as fetcher,b as decapitalize,o as debounce,p as compactStr,v as capitalize,c as camelToSnake};
