// @bun
var B=(...h)=>{console.log(`${new Date().toLocaleTimeString()}`,...h)};var I=(h,a=-1)=>{let f=new Map,K=(...x)=>{let c=JSON.stringify(x),z=Date.now(),j=f.get(c);if(j&&z<j.expiresAt)return j.value;let g=h((M)=>a=M,...x);if(g instanceof Promise){let M=g.then((H)=>{return f.set(c,{value:H,expiresAt:Date.now()+a*1000}),H});return f.set(c,{value:M,expiresAt:z+a*1000}),M}return f.set(c,{value:g,expiresAt:z+a*1000}),g};return K.clear=()=>f.clear(),K.updateTtl=(x)=>{a=x;let c=Date.now(),z=c+x*1000;for(let[j,V]of f.entries())if(V.expiresAt>c)V.expiresAt=z,f.set(j,V)},K};var W=(h)=>{return h?.constructor===Object};class v{cache;maxSize;constructor(h=10){this.cache=new Map,this.maxSize=h}get(h){let a=this.cache.get(h);if(!a)return;return this.cache.delete(h),this.cache.set(h,a),a}set(h,a){if(this.cache.has(h))this.cache.delete(h);else if(this.cache.size>=this.maxSize){let f=[...this.cache.keys()][0];if(f)this.cache.delete(f)}this.cache.set(h,a)}has(h){return this.cache.has(h)}}var D=v;var $=new D,Z=(h="",a={})=>{let f=async(K,x={})=>{let c=h?`${h}${K}`:K;if(W(x.body))x.body=JSON.stringify(x.body),x.headers={...a.headers,...x.headers,"Content-Type":"application/json"};let z=()=>fetch(c,x),j=x.method==="GET"||!x.method,V;if(!j)V=z();else{let H=$.get(c);if(!H)H=z(),$.set(c,H);V=H}let g=(await V).clone();if(!g.ok)throw Error(g.statusText);return await g.json()};return{get:(K,x={})=>f(K,{...x,method:"GET"}),post:(K,x,c={})=>f(K,{...c,method:"POST",body:x}),put:(K,x,c={})=>f(K,{...c,method:"PUT",body:x}),delete:(K,x={})=>f(K,{...x,method:"DELETE"})}},_=async(h)=>{try{return[null,await h]}catch(a){return[a,void 0]}};export{I as withCache,_ as to,B as timeLog,W as isObject,Z as fetcher};
