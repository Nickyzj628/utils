// @bun
var M=(...P)=>{console.log(`${new Date().toLocaleTimeString()}`,...P)};var Q=(P,W=-1)=>{let D=new Map,m=(...x)=>{let H=JSON.stringify(x),$=Date.now(),f=D.get(H);if(f&&$<f.expiresAt)return f.value;let z=W===-1?1/0:$+W*1000,K={setTtl:(F)=>z=$+F*1000},C=P.apply(K,x);if(C instanceof Promise){let F=C.then((J)=>{return D.set(H,{value:J,expiresAt:z}),J});return D.set(H,{value:F,expiresAt:z}),F}return D.set(H,{value:C,expiresAt:z}),C};return m.clear=()=>D.clear(),m.updateTtl=(x)=>{W=x;let H=Date.now(),$=H+x*1000;for(let[f,z]of D.entries())if(z.expiresAt>H)z.expiresAt=$,D.set(f,z)},m};var B=(P)=>{return P?.constructor===Object};var I=(...P)=>{return P.reduce((W,D)=>{if(!B(D))return W;return Object.keys(D).forEach((m)=>{let x=W[m],H=D[m];if(Array.isArray(x)&&Array.isArray(H))W[m]=[...x,...H];else if(B(H)&&B(x))W[m]=I(x,H);else W[m]=H}),W},{})};var E=(P="",W={})=>{let D=async(m,x={})=>{let H=P?`${P}${m}`:m,$=I(W,x);if(B($.body))$.body=JSON.stringify($.body),$.headers={...$.headers,"Content-Type":"application/json"};let f=await fetch(H,$);if(!f.ok)throw Error(f.statusText);return await f.json()};return{get:(m,x={})=>D(m,{...x,method:"GET"}),post:(m,x,H={})=>D(m,{...H,method:"POST",body:x}),put:(m,x,H={})=>D(m,{...H,method:"PUT",body:x}),delete:(m,x={})=>D(m,{...x,method:"DELETE"})}},T=async(P)=>{try{return[null,await P]}catch(W){return[W,void 0]}};var g=async(P=150)=>{return new Promise((W)=>{setTimeout(W,P)})};export{Q as withCache,T as to,M as timeLog,g as sleep,B as isObject,E as fetcher};
