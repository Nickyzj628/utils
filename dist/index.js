// @bun
var E=(...H)=>{console.log(`${new Date().toLocaleTimeString()}`,...H)};var T=(H,z=-1)=>{let W=new Map,$=(...x)=>{let D=JSON.stringify(x),I=Date.now(),Q=W.get(D);if(Q&&I<Q.expiresAt)return Q.value;let C=z===-1?1/0:I+z*1000,M={setTtl:(X)=>{C=I+X*1000}},Y=H.apply(M,x);if(Y instanceof Promise){let X=Y.then((Z)=>{return W.set(D,{value:Z,expiresAt:C}),Z});return W.set(D,{value:X,expiresAt:C}),X}return W.set(D,{value:Y,expiresAt:C}),Y};return $.clear=()=>W.clear(),$.updateTtl=(x)=>{z=x;let D=Date.now(),I=D+x*1000;for(let[Q,C]of W.entries())if(C.expiresAt>D)C.expiresAt=I,W.set(Q,C)},$};var J=(H)=>{return H?.constructor===Object},_=(H)=>{return H===null||H===void 0||typeof H!=="object"&&typeof H!=="function"},R=(H)=>{return!H},S=(H)=>{return!!H},G=(H)=>{return H===null||H===void 0};var f=(H,z)=>{let W={...H};for(let $ of Object.keys(z)){let x=W[$],D=z[$];if(_(x)&&_(D)){W[$]=D;continue}if(Array.isArray(x)&&Array.isArray(D)){W[$]=x.concat(D);continue}if(J(x)&&J(D)){W[$]=f(x,D);continue}W[$]=D}return W},P=(H,z)=>{if(Array.isArray(H))return H.map((W)=>P(W,z));if(J(H))return Object.keys(H).reduce(($,x)=>{let D=z(x),I=H[x];return $[D]=P(I,z),$},{});return H},q=(H,z)=>{if(Array.isArray(H))return H.map((W,$)=>{if(J(W))return q(W,z);return z(W,$)});if(J(H))return Object.keys(H).reduce(($,x)=>{let D=H[x];if(J(D)||Array.isArray(D))$[x]=q(D,z);else $[x]=z(D,x);return $},{});return H};var B=(H="",z={})=>{let W=async($,x={})=>{let D=new URL(H?`${H}${$}`:$),{params:I,parser:Q,...C}=f(z,x);if(J(I))Object.entries(I).forEach(([X,Z])=>{if(G(Z))return;D.searchParams.append(X,Z.toString())});if(J(C.body))C.body=JSON.stringify(C.body),C.headers={...C.headers,"Content-Type":"application/json"};let M=await fetch(D,C);if(!M.ok){if(M.headers.get("Content-Type")?.startsWith("application/json"))throw await M.json();throw Error(M.statusText)}return await(Q?.(M)??M.json())};return{get:($,x)=>W($,{...x,method:"GET"}),post:($,x,D)=>W($,{...D,method:"POST",body:x}),put:($,x,D)=>W($,{...D,method:"PUT",body:x}),delete:($,x)=>W($,{...x,method:"DELETE"})}},N=async(H)=>{try{return[null,await H]}catch(z){return[z,void 0]}};var m=(H)=>{return H.replace(/_([a-zA-Z])/g,(z,W)=>W.toUpperCase())},w=(H)=>{return H.replace(/([A-Z])/g,(z,W)=>`_${W.toLowerCase()}`)},g=(H)=>{return H.charAt(0).toUpperCase()+H.slice(1)},d=(H)=>{return H.charAt(0).toLowerCase()+H.slice(1)},c=async(H)=>{if(!H.startsWith("http"))throw Error("\u56FE\u7247\u5730\u5740\u5FC5\u987B\u4EE5http\u6216https\u5F00\u5934");let z="",W=await B().get(H,{parser:(D)=>{return z=D.headers.get("Content-Type")||"image/jpeg",D.arrayBuffer()}}),x=Buffer.from(W).toString("base64");return`data:${z};base64,${x}`};var v=async(H=150)=>{return new Promise((z)=>{setTimeout(z,H)})};export{T as withCache,N as to,E as timeLog,m as snakeToCamel,v as sleep,f as mergeObjects,q as mapValues,P as mapKeys,S as isTruthy,_ as isPrimitive,J as isObject,G as isNil,R as isFalsy,c as imageUrlToBase64,B as fetcher,d as decapitalize,g as capitalize,w as camelToSnake};
